---
title: "results_section"
output:
  word_document: default
  html_document: default
---

This just makes the results section so I can knit to word and if I change anything in the analysis, I can run this to update the coefficients in the text.

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(dplyr)
library(tidyverse)
```

```{r}
final_dat <- read.csv("/Users/ccalmasini/Desktop/Camilla KHANDLE/social_networks_paper/social_nets_dat_both_waves.csv")
int_score_coefs <- read.csv("/Users/ccalmasini/Desktop/Camilla KHANDLE/social_networks_paper/Tables/w1_regressions_int_score.csv")
confi_coefs <- read.csv("/Users/ccalmasini/Desktop/Camilla KHANDLE/social_networks_paper/Tables/w1_regressions_confi.csv")

khandle1_tab <- final_dat %>%
  mutate(W1_EDU_new_c = W1_EDU_new - 12,
         W1_D_GENDER = factor(case_when(W1_D_GENDER == 1 ~ "Male",
                                        W1_D_GENDER == 2 ~ "Female")),
         W1_SMK = ifelse(W1_SMK == 0, "No", "Yes"),
         years_over_65 = W1_INTERVIEW_AGE - 65, 
         int_score = ifelse(int_score == 0, 1, int_score)) %>%
  drop_na(W1_EDU_new_c, income_num, ADL_IADL, tot_drinks_week, retirement_stat)

n_sample <- nrow(khandle1_tab) %>% round(3)
avg_age <- mean(khandle1_tab$W1_INTERVIEW_AGE) %>% round(3)
sd_age <- sd(khandle1_tab$W1_INTERVIEW_AGE) %>% round(3)
perc_male <- (nrow(khandle1_tab[khandle1_tab$W1_D_GENDER == "Male",])/nrow(khandle1_tab)*100) %>% round(3)

int_score_summary <- list()

for(i in unique(khandle1_tab$W1_D_RACE_SUMMARY)){
  int_score_summary[[i]]$avg <- mean(khandle1_tab[khandle1_tab$W1_D_RACE_SUMMARY == i, "int_score"]) %>% round(3)
  int_score_summary[[i]]$sd <- sd(khandle1_tab[khandle1_tab$W1_D_RACE_SUMMARY == i, "int_score"]) %>% round(3)
}
```

```{r}
#is there a significant difference between mean integration score by race?
int_score_race <- aov(int_score~W1_D_RACE_SUMMARY, data = khandle1_tab)
summary(int_score_race)

ggplot(khandle1_tab, aes(x = int_score))+
  geom_histogram()+
  facet_grid(~W1_D_RACE_SUMMARY)

#is retirement status associated with volunteer status?
chisq.test(table(khandle1_tab$retirement_stat, khandle1_tab$volunteer_bin))

m <- glm(volunteer_bin~retirement_stat, data = khandle1_tab, family = 'binomial')
summary(m)
```

The sample characteristics for the `r n_sample` KHANDLE participants included in our analysis are shown in table 1. 
The average age for participants was `r avg_age`, SD = `r sd_age` and `r perc_male` of participants were male. 
Participants with higher integrations scores were slightly younger and more likely to be male.  The distribution of integration score did not differ substantially by race/ethnicity and average integration score was similar for Asian `r int_score_summary$Asian$avg`, SD = `r int_score_summary$Asian$sd`, Black (`r int_score_summary$Black$avg`, SD = `r int_score_summary$Black$sd`), Latino (`r int_score_summary$LatinX$avg`, SD = `r int_score_summary$LatinX$sd`, and White (`r int_score_summary$White$avg`, SD = `r int_score_summary$White$sd`) participants. 

Higher social integration score was associated with better cognitive scores in covariate-adjusted models $\beta$ = `r int_score_coefs[1, 2]`; this association attenuated slightly when adjusting for all covariates $\beta$ = `r int_score_coefs[1, 3]` (table 2).  In race-stratified, covariate-adjusted models, higher social integration scores were associated with better cognitive scores among Asian ($\beta$ = `r int_score_coefs[2, 2]`), Black ($\beta$ = `r int_score_coefs[3, 2]`), Latinx: $\beta$ = `r int_score_coefs[4, 2]`, and White: $\beta$ = `r int_score_coefs[5, 2]` participants (Table 3). In models adjusted for all covariates, the confidence intervals were wide and the association remained statistically significant only for Black participants (Black: $\beta$ = `r int_score_coefs[3, 3]`. Lastly, the coefficients obtained using multiple imputation were similar to the ones from the complete cases analysis.  
When evaluating the effect of having a confidante that one sees daily, we found that having a confidante results in a higher average cognition score ($\beta$ = `r confi_coefs[1, 2]`). In race-stratified models, we found a significant association for Asian participants only (Asian: $\beta$ = `r confi_coefs[2, 2]`, Black: $\beta$ = `r confi_coefs[3, 2]`), LatinX: $\beta$ = `r confi_coefs[4, 2]`, White: $\beta$ = `r confi_coefs[5, 2]`) (table 3). We found similar results in the all-covariates adjusted models.
